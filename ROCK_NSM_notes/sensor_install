# Sensor Install

Basic guide to install Sensor.
1. choose f11 to select uefi boot
2. set date time to UTC 24 hours
3. minimal install.

Partition Information
1. Create OS disk (use smallest drive)
   label the smaller disk as OS
   label the larger disk as DATA 
2. partition LVM (x2 volume, disks)

Disk Partton Requirements
/data   --- use all of disk
/root   --- 2 GB
/root/efi   200 MB
/       --- 10 GB
/home   --- 18 GB

OS volume
1. / -> os volume -- 18G
2. /boot -> os volume --2G
3. /boot/efi -> os volume -- 200M
4. no swap space
5. format XFS  \

Data Volume
1. Create /data disks  500G
2. /data -> data volume

note:
set the parition
select the size to be 1
change/edit the disk size later

Hostname and Network configuration
   select the port ens0s31f6 (port close the outside edge)
1. set hostname: sg6-team.local.lan
2. ethernet management port - select on
3. set ip 172.16.60.100/24
4. set the DNS to 192.168.2.1
5. autoconnect
6. ignore IPv6


Configuring accounts
1. create user account admin and make user an administrator
2. set password for admin account
3. DO NOT set a root accout nor password.  Sensor does not need a root user!

ALWAYS SECURE YOUR SENSOR HOST!!!!

Disabling the Bell sound
1. Disable bell sound -
2. sudo vi /etc/inputrc -- uncomment "Set bell style none"
3. after setting bell style by running: sudo  bind -f /etc/inputrc

username: admin
pass: perched


### Disable ipv6
vi /etc/sysctl.conf

net.ipv6.conf.all.disable_ipv6 = 1
net.ipv6.conf.default.disable_ipv6 = 1
net.ipv6.conf.lo.disable_ipv6 = 1

:wq

sysctl -p
sudo systemctl restart network

### Repo and yum update

cd /etc/yum.repos.d/
rm *
yes

vim perched.repo
[base-local]
name=My_local_repo
baseurl=http://repo/repos/base
enabled=1
gpgcheck=0

[epel-local]
name=epel-local
baseurl=http://repo/repos/epel
enabled=1
gpgcheck=0

[extras-local]
name=extras-local
baseurl=http://repo/repos/extras
enabled=1
gpgcheck=0

[rpmforge-local]
name=rpmforge-local
baseurl=http://repo/repos/rpmforge
enabled=1
gpgcheck=0

[updates-local]
name=updates-local
baseurl=http://repo/repos/updates
enabled=1
gpgcheck=0

[copr-rocknsm-2.1-local]
name=copr-rock-local
baseurl=http://repo/repos/copr-rocknsm-2.1
enabled=1
gpgcheck=0

:wq

yum -y update

### Install stenographer
sudo yum -y install stenographer

### Configure stenographer
sudo vim /etc/stenographer/config

### edit the the field PacketDirectorr and IndexDirectory
# change the Port to 8083
{
  "Threads": [
    { "PacketsDirectory": "/data/stenographer/packets"
    , "IndexDirectory": "/data/stenographer/index"
    , "MaxDirectoryFiles": 30000
    , "DiskFreePercentage": 10
    }
  ]
  , "StenotypePath": "/usr/bin/stenotype"
  , "Interface": "enp2s0"
  , "Port": 8083
  , "Host": "127.0.0.1"
  , "Flags": []
  , "CertPath": "/etc/stenographer/certs"
}

### key creation
cd /etc/stenographer
sudo stenokeys.sh stenographer stenographer

### create stenographer data directories

cd /data
<<<<<<< HEAD
sudo mkdir -p stenographer/{packets,index}
cd ..
sudo chown -R stenographer:stenographer stenographer
=======

cd ..
sudo chown -R stenographer:stenographer stenographer

### edit hosts file and disable the IPV6
sudo vim /etc/hosts
delete  ::1
:wq

### after 30 seconds 
sudo systemctl stop stenographer
=======

### configure the filewall to allow port 8083
sudo firewall-cmd --add-port=8083/tcp --permanent
sudo firewall-cmd --reload

sudo systemctl enable stenographer
sudo systemctl start stenographer

# after 30 seconds 
sudo systemctl stop stenographer
sudo systemctl start stenographer

### Suricata installation and configuration 
           
yum -y install suricata



systemctl enable suricata
systemctl start suricata           
systemctl status suricata

